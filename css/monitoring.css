/* ---------- Basic Admin-like Layout ---------- */
:root{
  --bg:#0b0d10;
  --panel:#121416;
  --muted:#9aa0a6;
  --accent:#0d6efd;
  --card-border:#222428;
}

html,body { height:100%; background:var(--bg); color:#e9eef2; font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial; }

/* Sidebar */
.sidebar {
  width:260px;
  background: linear-gradient(180deg,#0f1113 0%, #0a0b0c 100%);
  border-right:1px solid var(--card-border);
  min-height:100vh;
  padding:12px;
  position:fixed;
  left:0; top:0; bottom:0;
  overflow:auto;
}
.main-content {
  margin-left:260px;
}

/* Header */
.topbar {
  height:64px;
  background: linear-gradient(90deg,#0c0d10,#0b0c0e);
  border-bottom:1px solid var(--card-border);
  display:flex; align-items:center; justify-content:space-between;
  padding:0 18px;
  position:sticky; top:0; z-index:1050;
}
.brand { font-weight:600; color:#fff; letter-spacing:.2px; }

/* Page container */
.page-container {
  display:flex;
  gap:18px;
  padding:18px;
  align-items:flex-start;
}

/* Left (filters + incidents) */
.panel {
  background:linear-gradient(180deg,#111315,#0f1113);
  border:1px solid var(--card-border);
  border-radius:10px;
  padding:12px;
}
.panel h5 { color:#fff; margin-bottom:8px; }
.scroll-y { max-height:calc(100vh - 200px); overflow:auto; padding-right:6px; }

/* Map column */
#map {
  width:100%;
  height:calc(100vh - 140px);
  border-radius:10px;
  border:1px solid var(--card-border);
  overflow:hidden;
}
.map-controls {
  position:absolute; z-index:1200; left:16px; top:86px;
  display:flex; flex-direction:column; gap:8px;
}

.map-controls .btn {
  background:rgba(255,255,255,0.06);
  color:#fff; border:1px solid rgba(255,255,255,0.04);
  width:40px; height:40px; display:flex; align-items:center; justify-content:center;
  border-radius:8px;
}

/* Right column */
.right-col { width:320px; }

/* Incident item */
.incident-item {
  background:#141618; border:1px solid #2a2c2f; padding:10px; border-radius:8px; margin-bottom:10px;
}
.incident-item small { color:var(--muted); }

/* legend icons */
.legend .dot { width:12px; height:12px; border-radius:50%; display:inline-block; margin-right:8px; vertical-align:middle; }

/* responsive */
@media (max-width: 991px){
  .sidebar { position:relative; width:100%; min-height:auto; display:flex; gap:10px; overflow:hidden; }
  .main-content { margin-left:0; }
  .page-container { flex-direction:column; padding:12px; }
  .right-col{ width:100%; }
  #map { height:400px; }
}

/* small helpers */
.muted { color:var(--muted); font-size:13px; }
.kpi { font-size:20px; font-weight:700; }
.card-title { font-size:14px; color:#dfe7eb; margin-bottom:6px; }

/* Ensure canvas layout is stable and visible during initial render */
.panel canvas { display: block; width: 100% !important; height: auto !important; }
.right-col { position: relative; } /* ensure ResizeObserver sees stable box */

/* Chart container: fixed height, canvas fills it absolutely to avoid layout jumps */
.chart-container { position: relative; width: 100%; overflow: visible; }
.chart-container.chart-lg { height: 150px; }
.chart-container.chart-sm { height: 120px; }
.chart-container canvas { position: absolute !important; top: 0; left: 0; width: 100% !important; height: 100% !important; }

/* Prevent CSS/JS-driven transforms/animations from shifting canvases */
.panel canvas, .chart-container canvas { transition: none !important; animation: none !important; transform: none !important; }